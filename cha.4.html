<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>4. è©¦ç®—è¡¨ - ICT å­¸ç¿’è³‡æºç¶²</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&display=swap" rel="stylesheet">
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    
    <style>
        body { font-family: 'Noto Sans TC', sans-serif; background-color: #f0f9ff; }
        
        /* æ¨¡æ“¬è©¦ç®—è¡¨æ¨£å¼ */
        .sheet-wrapper { overflow-x: auto; border: 1px solid #cbd5e1; border-radius: 8px; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1); }
        .sheet-table { border-collapse: collapse; width: 100%; min-width: 600px; background: white; font-family: 'Courier New', monospace; }
        .sheet-table th, .sheet-table td { border: 1px solid #e2e8f0; padding: 8px 12px; text-align: center; position: relative; height: 40px; }
        .sheet-header-col { background-color: #f8fafc; font-weight: bold; color: #64748b; width: 40px; }
        .sheet-header-row { background-color: #f8fafc; font-weight: bold; color: #64748b; }
        
        /* å„²å­˜æ ¼äº’å‹• */
        .sheet-cell { cursor: cell; transition: all 0.1s; }
        .sheet-cell:hover { background-color: #f1f5f9; }
        .sheet-cell.active { border: 2px solid #2563eb; background-color: #eff6ff; z-index: 10; }
        .formula-bar-input { font-family: 'Courier New', monospace; }

        /* å¡ç‰‡ç‰¹æ•ˆ */
        .hover-card { transition: all 0.3s ease; }
        .hover-card:hover { transform: translateY(-3px); box-shadow: 0 10px 20px rgba(0,0,0,0.1); }

        /* å‡½æ•¸æ¨™ç±¤ */
        .func-tag { @apply px-2 py-0.5 rounded text-xs font-mono font-bold; }
        
        /* åœ–è¡¨åˆ‡æ›æŒ‰éˆ• */
        .chart-btn.active { @apply bg-indigo-600 text-white border-indigo-600; }
        
        /* åƒç…§æ¨¡æ“¬å™¨å‹•ç•« */
        .ref-anim-box { transition: transform 0.5s cubic-bezier(0.4, 0, 0.2, 1); }
        
        /* æ’åºè¡¨æ ¼æ¨£å¼ */
        .sortable-th { cursor: pointer; user-select: none; }
        .sortable-th:hover { background-color: #e2e8f0; }

        /* VLOOKUP Table Highlight */
        .highlight-lookup { background-color: #fef3c7; border: 2px solid #f59e0b; }
        .highlight-result { background-color: #d1fae5; border: 2px solid #10b981; font-weight: bold; }
    </style>
</head>
<body class="text-slate-700 flex flex-col min-h-screen">

    <!-- é ‚éƒ¨å°èˆª -->
    <header class="bg-indigo-700 text-white shadow-lg sticky top-0 z-50">
        <div class="container mx-auto px-4 py-3 flex justify-between items-center">
            <div class="flex items-center gap-4">
                <a href="index.html" class="hover:bg-indigo-600 p-2 rounded-lg transition" title="å›é¦–é ">
                    <i data-lucide="home" class="w-6 h-6"></i>
                </a>
                <span class="font-bold text-lg hidden md:block">å¿…ä¿®éƒ¨åˆ† A > 4. è©¦ç®—è¡¨</span>
            </div>
            <div class="text-sm bg-indigo-800 px-3 py-1 rounded-full flex items-center gap-2">
                <i data-lucide="table" class="w-4 h-4"></i> 
                <span class="hidden sm:inline">æ•¸æ“šè™•ç†èˆ‡åˆ†æ</span>
            </div>
        </div>
        <!-- é€²åº¦æ¢ -->
        <div class="h-1 bg-indigo-900 w-full">
            <div id="progressBar" class="h-full bg-cyan-400 w-0 transition-all duration-300"></div>
        </div>
    </header>

    <main class="container mx-auto px-4 py-8 max-w-5xl space-y-16 flex-grow">

        <!-- 4.1 è©¦ç®—è¡¨ç°¡ä»‹ Introduction -->
        <section id="sec4-1" class="scroll-mt-24">
            <div class="flex items-center gap-3 mb-6">
                <span class="bg-indigo-100 text-indigo-700 px-3 py-1 rounded-full font-bold text-sm">4.1</span>
                <h2 class="text-3xl font-bold text-slate-800">è©¦ç®—è¡¨ç°¡ä»‹ (Introduction)</h2>
            </div>

            <div class="bg-white p-6 rounded-2xl shadow-sm border border-gray-200 mb-8">
                <p class="text-slate-600 mb-6 leading-relaxed">
                    è©¦ç®—è¡¨è»Ÿä»¶ï¼ˆå¦‚ Microsoft Excelï¼‰ç”±<span class="font-bold text-indigo-600">æ´»é ç°¿ (Workbook)</span>çµ„æˆï¼Œæ¯æœ¬æ´»é ç°¿åŒ…å«å¤šå¼µ<span class="font-bold text-indigo-600">å·¥ä½œè¡¨ (Worksheet)</span>ã€‚å·¥ä½œè¡¨å‰‡æ˜¯ç”±æ¬„ (Column) å’Œåˆ— (Row) äº¤ç¹”è€Œæˆçš„ç¶²æ ¼ã€‚
                </p>

                <!-- æ¨¡æ“¬ä»‹é¢ -->
                <div class="border border-slate-300 rounded-lg overflow-hidden bg-gray-50 shadow-inner">
                    <div class="bg-white border-b border-slate-300 p-2 flex items-center gap-4 text-xs text-slate-600">
                        <div class="flex items-center gap-1 border px-2 py-1 rounded bg-gray-50">
                            <span class="font-bold text-indigo-600">åç¨±æ–¹å¡Š:</span>
                            <span id="nameBox" class="font-mono w-8 text-center">A1</span>
                        </div>
                        <div class="flex-grow flex items-center gap-2 border px-2 py-1 rounded bg-white">
                            <span class="font-bold text-indigo-600">fx</span>
                            <input type="text" id="formulaBar" class="w-full outline-none formula-bar-input text-slate-700" value="å§“å" readonly>
                        </div>
                    </div>

                    <div class="sheet-wrapper">
                        <table class="sheet-table">
                            <thead>
                                <tr>
                                    <th class="sheet-header-col"></th>
                                    <th class="sheet-header-row">A</th>
                                    <th class="sheet-header-row">B</th>
                                    <th class="sheet-header-row">C</th>
                                    <th class="sheet-header-row">D</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <th class="sheet-header-col">1</th>
                                    <td class="sheet-cell active" onclick="activateCell(this, 'A1', 'å§“å')">å§“å</td>
                                    <td class="sheet-cell" onclick="activateCell(this, 'B1', 'æ¸¬é©— 1')">æ¸¬é©— 1</td>
                                    <td class="sheet-cell" onclick="activateCell(this, 'C1', 'æ¸¬é©— 2')">æ¸¬é©— 2</td>
                                    <td class="sheet-cell" onclick="activateCell(this, 'D1', 'ç¸½åˆ†')">ç¸½åˆ†</td>
                                </tr>
                                <tr>
                                    <th class="sheet-header-col">2</th>
                                    <td class="sheet-cell" onclick="activateCell(this, 'A2', 'Chris')">Chris</td>
                                    <td class="sheet-cell" onclick="activateCell(this, 'B2', '85')">85</td>
                                    <td class="sheet-cell" onclick="activateCell(this, 'C2', '90')">90</td>
                                    <td class="sheet-cell text-indigo-600 font-bold" onclick="activateCell(this, 'D2', '=B2+C2')">175</td>
                                </tr>
                                <tr>
                                    <th class="sheet-header-col">3</th>
                                    <td class="sheet-cell" onclick="activateCell(this, 'A3', 'Sam')">Sam</td>
                                    <td class="sheet-cell" onclick="activateCell(this, 'B3', '70')">70</td>
                                    <td class="sheet-cell" onclick="activateCell(this, 'C3', '65')">65</td>
                                    <td class="sheet-cell text-indigo-600 font-bold" onclick="activateCell(this, 'D3', '=B3+C3')">135</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="mt-4 flex gap-4 text-sm text-slate-500">
                    <span class="flex items-center gap-1"><i data-lucide="grid" class="w-4 h-4"></i> å„²å­˜æ ¼ (Cell)ï¼šA1, B2</span>
                    <span class="flex items-center gap-1"><i data-lucide="maximize" class="w-4 h-4"></i> ç¯„åœ (Range)ï¼šA1:C3</span>
                </div>
            </div>
        </section>

        <!-- 4.2 æ•¸æ“šè¼¸å…¥ Data Entry -->
        <section id="sec4-2" class="scroll-mt-24">
            <div class="flex items-center gap-3 mb-6">
                <span class="bg-indigo-100 text-indigo-700 px-3 py-1 rounded-full font-bold text-sm">4.2</span>
                <h2 class="text-3xl font-bold text-slate-800">æ•¸æ“šè¼¸å…¥ (Data Entry)</h2>
            </div>

            <div class="grid md:grid-cols-2 gap-8 mb-8">
                <!-- æ•¸æ“šé¡å‹ä»‹ç´¹ -->
                <div class="space-y-4">
                    <div class="bg-white p-4 rounded-xl border border-gray-200 hover-card">
                        <h4 class="font-bold text-orange-600 flex items-center gap-2"><i data-lucide="type" class="w-5 h-5"></i> æ–‡å­— (Label)</h4>
                        <p class="text-xs text-slate-600">éæ•¸å€¼æ•¸æ“šï¼Œé è¨­<span class="font-bold">é å·¦å°é½Š</span>ã€‚ç„¡æ³•é€²è¡Œæ•¸å­¸é‹ç®—ã€‚</p>
                    </div>
                    <div class="bg-white p-4 rounded-xl border border-gray-200 hover-card">
                        <h4 class="font-bold text-emerald-600 flex items-center gap-2"><i data-lucide="hash" class="w-5 h-5"></i> æ•¸å€¼ (Value)</h4>
                        <p class="text-xs text-slate-600">æ•¸å­—ã€æ—¥æœŸã€æ™‚é–“ï¼Œé è¨­<span class="font-bold">é å³å°é½Š</span>ã€‚å¯é€²è¡Œé‹ç®—ã€‚</p>
                    </div>
                </div>

                <!-- äº’å‹•è¼¸å…¥åµæ¸¬å™¨ -->
                <div class="bg-slate-50 p-6 rounded-xl border border-slate-200">
                    <h4 class="font-bold text-slate-700 mb-4 flex items-center gap-2">
                        <i data-lucide="scan-line" class="w-5 h-5 text-indigo-500"></i> æ™ºèƒ½æ•¸æ“šåµæ¸¬å™¨
                    </h4>
                    <input type="text" id="dataInput" class="w-full p-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 mb-4" placeholder="è©¦è¼¸å…¥ï¼šHello æˆ– 123 æˆ– 2024-01-01" oninput="detectDataType()">
                    <div id="dataResult" class="p-3 bg-white rounded-lg border border-slate-200 text-center text-sm font-bold text-slate-400">
                        ç­‰å¾…è¼¸å…¥...
                    </div>
                    <div id="formatPreview" class="mt-4 text-xs text-slate-500 hidden">
                        <p class="font-bold mb-1">æ ¼å¼åŒ–é è¦½ (Formatting)ï¼š</p>
                        <ul class="list-disc list-inside">
                            <li>è²¨å¹£ï¼š<span id="fmtCurrency">-</span></li>
                            <li>ç™¾åˆ†æ¯” (x100)ï¼š<span id="fmtPercent">-</span></li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <!-- 4.3 å…¬å¼ Formula -->
        <section id="sec4-3" class="scroll-mt-24">
            <div class="flex items-center gap-3 mb-6">
                <span class="bg-indigo-100 text-indigo-700 px-3 py-1 rounded-full font-bold text-sm">4.3</span>
                <h2 class="text-3xl font-bold text-slate-800">å…¬å¼ (Formula)</h2>
            </div>

            <div class="bg-white p-6 rounded-2xl shadow-sm border border-gray-200">
                <p class="text-slate-600 mb-6">å…¬å¼å¿…é ˆä»¥ <span class="font-bold text-xl text-indigo-600 font-mono">=</span> ç¬¦è™Ÿé–‹å§‹ã€‚é›»è…¦æœƒä¾æ“šé‹ç®—ç¬¦è™Ÿçš„å„ªå…ˆæ¬¡åºè¨ˆç®—ã€‚</p>
                
                <div class="grid md:grid-cols-2 gap-8">
                    <div>
                        <h4 class="font-bold text-slate-700 mb-3">ç®—è¡“é‹ç®—ç¬¦è™Ÿ (Operators)</h4>
                        <ul class="space-y-2 text-sm">
                            <li class="flex justify-between bg-slate-50 p-2 rounded"><span>+ (åŠ )</span> <span>=A1+B1</span></li>
                            <li class="flex justify-between bg-slate-50 p-2 rounded"><span>- (æ¸›)</span> <span>=A1-B1</span></li>
                            <li class="flex justify-between bg-slate-50 p-2 rounded"><span>* (ä¹˜)</span> <span>=A1*B1</span></li>
                            <li class="flex justify-between bg-slate-50 p-2 rounded"><span>/ (é™¤)</span> <span>=A1/B1</span></li>
                            <li class="flex justify-between bg-slate-50 p-2 rounded"><span>^ (æŒ‡æ•¸)</span> <span>=A1^2</span></li>
                        </ul>
                    </div>
                    
                    <div class="bg-indigo-50 p-5 rounded-xl border border-indigo-100">
                        <h4 class="font-bold text-indigo-800 mb-2">é‹ç®—å„ªå…ˆæ¬¡åº (Priority)</h4>
                        <ol class="list-decimal list-inside text-sm text-indigo-700 space-y-1 mb-4">
                            <li>æ‹¬è™Ÿ ( )</li>
                            <li>æŒ‡æ•¸ ^</li>
                            <li>ä¹˜ * ã€ é™¤ /</li>
                            <li>åŠ  + ã€ æ¸› -</li>
                        </ol>
                        <div class="bg-white p-3 rounded-lg border border-indigo-200">
                            <p class="text-xs text-slate-500 mb-1">ä¾‹å­ï¼š</p>
                            <code class="block text-center text-lg font-bold text-slate-800">= 5 + 2 * 3</code>
                            <p class="text-center text-emerald-600 font-bold mt-1">= 11 <span class="text-xs font-normal text-slate-400">(ä¸æ˜¯ 21)</span></p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- 4.4 å‡½æ•¸ Functions (UPDATED) -->
        <section id="sec4-4" class="scroll-mt-24">
            <div class="flex items-center gap-3 mb-6">
                <span class="bg-indigo-100 text-indigo-700 px-3 py-1 rounded-full font-bold text-sm">4.4</span>
                <h2 class="text-3xl font-bold text-slate-800">å‡½æ•¸ (Functions)</h2>
            </div>

            <p class="text-slate-600 mb-6">å‡½æ•¸æ˜¯é è¨­çš„å…¬å¼ï¼Œç”¨ä¾†ç°¡åŒ–è¤‡é›œçš„è¨ˆç®—ã€‚ä»¥ä¸‹æ˜¯é€²éšå‡½æ•¸çš„è©³ç´°è§£èªªèˆ‡ç¯„ä¾‹ã€‚</p>

            <!-- å‡½æ•¸åˆ†é¡å±•ç¤º -->
            <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6 mb-12">
                <!-- åŸºç¤æ•¸å­¸èˆ‡çµ±è¨ˆ -->
                <div class="bg-white p-5 rounded-xl border border-slate-200 shadow-sm">
                    <h4 class="font-bold text-slate-800 mb-3 border-b pb-2 flex items-center gap-2"><i data-lucide="calculator" class="w-4 h-4 text-blue-500"></i> åŸºç¤çµ±è¨ˆ</h4>
                    <ul class="space-y-3 text-sm">
                        <li><code class="text-blue-600 font-bold">=SUM(ç¯„åœ)</code><br><span class="text-xs text-slate-500">è¨ˆç®—ç¸½å’Œã€‚ä¾‹: =SUM(A1:A5) -> 100</span></li>
                        <li><code class="text-blue-600 font-bold">=AVERAGE(ç¯„åœ)</code><br><span class="text-xs text-slate-500">è¨ˆç®—å¹³å‡å€¼ã€‚ä¾‹: =AVERAGE(B1:B5) -> 50</span></li>
                        <li><code class="text-blue-600 font-bold">=MAX(ç¯„åœ) / MIN(ç¯„åœ)</code><br><span class="text-xs text-slate-500">æ‰¾å‡ºæœ€å¤§/æœ€å°å€¼ã€‚</span></li>
                        <li><code class="text-blue-600 font-bold">=COUNT(ç¯„åœ)</code><br><span class="text-xs text-slate-500">è¨ˆç®—åŒ…å«<b>æ•¸å­—</b>çš„å„²å­˜æ ¼æ•¸ç›®ã€‚</span></li>
                    </ul>
                </div>

                <!-- æ¢ä»¶èˆ‡é‚è¼¯ -->
                <div class="bg-white p-5 rounded-xl border border-slate-200 shadow-sm">
                    <h4 class="font-bold text-slate-800 mb-3 border-b pb-2 flex items-center gap-2"><i data-lucide="git-branch" class="w-4 h-4 text-purple-500"></i> æ¢ä»¶é‚è¼¯</h4>
                    <ul class="space-y-3 text-sm">
                        <li><code class="text-purple-600 font-bold">=IF(æ¢ä»¶, çœŸå€¼, å‡å€¼)</code><br><span class="text-xs text-slate-500">æ¢ä»¶åˆ¤æ–·ã€‚ä¾‹: =IF(A1>=50, "åŠæ ¼", "ä¸åŠæ ¼")</span></li>
                        <li><code class="text-purple-600 font-bold">=COUNTIF(ç¯„åœ, æº–å‰‡)</code><br><span class="text-xs text-slate-500">è¨ˆç®—ç¬¦åˆæ¢ä»¶çš„å€‹æ•¸ã€‚ä¾‹: =COUNTIF(A1:A10, ">50") -> 5 (äºº)</span></li>
                        <li><code class="text-purple-600 font-bold">=SUMIF(ç¯„åœ, æº–å‰‡, [åŠ ç¸½ç¯„åœ])</code><br><span class="text-xs text-slate-500">åŠ ç¸½ç¬¦åˆæ¢ä»¶çš„æ•¸å€¼ã€‚ä¾‹: =SUMIF(B1:B10, "Apple", C1:C10) -> è¨ˆç®—è˜‹æœçš„ç¸½éŠ·é‡</span></li>
                    </ul>
                </div>

                <!-- æ–‡å­—è™•ç† -->
                <div class="bg-white p-5 rounded-xl border border-slate-200 shadow-sm">
                    <h4 class="font-bold text-slate-800 mb-3 border-b pb-2 flex items-center gap-2"><i data-lucide="type" class="w-4 h-4 text-orange-500"></i> æ–‡å­—è™•ç†</h4>
                    <ul class="space-y-3 text-sm">
                        <li><code class="text-orange-600 font-bold">=LEN(æ–‡å­—)</code><br><span class="text-xs text-slate-500">è¨ˆç®—å­—ç¬¦é•·åº¦ã€‚ä¾‹: =LEN("Hello") -> 5</span></li>
                        <li><code class="text-orange-600 font-bold">=LEFT(æ–‡å­—, n)</code><br><span class="text-xs text-slate-500">å–å·¦é‚Š n å€‹å­—ã€‚ä¾‹: =LEFT("A123", 1) -> "A"</span></li>
                        <li><code class="text-orange-600 font-bold">=RIGHT(æ–‡å­—, n)</code><br><span class="text-xs text-slate-500">å–å³é‚Š n å€‹å­—ã€‚ä¾‹: =RIGHT("A123", 3) -> "123"</span></li>
                        <li><code class="text-orange-600 font-bold">=MID(æ–‡å­—, start, n)</code><br><span class="text-xs text-slate-500">å¾ä¸­é–“å–å­—ã€‚ä¾‹: =MID("HK1234", 3, 4) -> "1234"</span></li>
                    </ul>
                </div>

                <!-- æŸ¥æ‰¾åƒç…§ (Advanced) -->
                <div class="col-span-1 md:col-span-2 lg:col-span-3 bg-white p-5 rounded-xl border border-slate-200 shadow-sm">
                    <h4 class="font-bold text-slate-800 mb-3 border-b pb-2 flex items-center gap-2"><i data-lucide="search" class="w-4 h-4 text-emerald-500"></i> æŸ¥æ‰¾åƒç…§ (Lookup)</h4>
                    <div class="grid md:grid-cols-2 gap-6">
                        <div>
                            <code class="text-emerald-600 font-bold block mb-1">=VLOOKUP(æŸ¥é–±å€¼, è¡¨æ ¼ç¯„åœ, æ¬„è™Ÿ, [åŒ¹é…æ¨¡å¼])</code>
                            <p class="text-xs text-slate-600 mb-2">å‚ç›´æŸ¥æ‰¾ã€‚åœ¨è¡¨æ ¼çš„ç¬¬ä¸€æ¬„å°‹æ‰¾ã€ŒæŸ¥é–±å€¼ã€ï¼Œç„¶å¾Œå‚³å›è©²åˆ—æŒ‡å®šã€Œæ¬„è™Ÿã€çš„è³‡æ–™ã€‚</p>
                            <div class="bg-gray-100 p-2 rounded text-xs font-mono">
                                A | B<br>
                                101 | Apple<br>
                                102 | Orange<br>
                                =VLOOKUP(101, A:B, 2, FALSE) -> "Apple"
                            </div>
                        </div>
                        <div>
                            <code class="text-emerald-600 font-bold block mb-1">=XLOOKUP(æŸ¥é–±å€¼, æŸ¥é–±é™£åˆ—, å‚³å›é™£åˆ—, ...)</code>
                            <p class="text-xs text-slate-600 mb-2">æ–°ä¸€ä»£æŸ¥æ‰¾å‡½æ•¸ã€‚æ›´éˆæ´»ï¼Œä¸éœ€è¦æŒ‡å®šæ¬„è™Ÿï¼Œå¯å‘å·¦æˆ–å‘å³æŸ¥æ‰¾ã€‚</p>
                            <div class="bg-gray-100 p-2 rounded text-xs font-mono">
                                =XLOOKUP(102, A:A, B:B) -> "Orange"
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- å‡½æ•¸å¯¦é©—å®¤ (Expanded) -->
            <div class="bg-slate-800 rounded-2xl p-6 text-white shadow-xl">
                <h3 class="text-xl font-bold mb-4 flex items-center gap-2"><i data-lucide="flask-conical" class="w-5 h-5 text-yellow-400"></i> å‡½æ•¸å¯¦é©—å®¤</h3>
                <div class="grid md:grid-cols-2 gap-8">
                    <div class="space-y-4">
                        <div class="bg-slate-700 p-4 rounded-lg text-sm">
                            <p class="mb-2 font-bold text-slate-300">æ¸¬è©¦æ•¸æ“š (Data)ï¼š</p>
                            <div class="font-mono text-xs text-slate-400">
                                A1: "Apple" &nbsp;&nbsp; B1: 50<br>
                                A2: "Banana" &nbsp; B2: 30<br>
                                A3: "Apple" &nbsp;&nbsp; B3: 20<br>
                                A4: "Orange" &nbsp; B4: 80
                            </div>
                        </div>
                        
                        <div class="space-y-2">
                            <p class="text-xs text-slate-400 mb-1">é»æ“Šæ¸¬è©¦å‡½æ•¸ï¼š</p>
                            <div class="flex flex-wrap gap-2">
                                <button onclick="runAdvFunc('LEN')" class="bg-orange-600 hover:bg-orange-500 px-3 py-1 rounded text-xs font-mono transition">LEN("Apple")</button>
                                <button onclick="runAdvFunc('LEFT')" class="bg-orange-600 hover:bg-orange-500 px-3 py-1 rounded text-xs font-mono transition">LEFT("HK123",2)</button>
                                <button onclick="runAdvFunc('COUNTIF')" class="bg-purple-600 hover:bg-purple-500 px-3 py-1 rounded text-xs font-mono transition">COUNTIF("Apple")</button>
                                <button onclick="runAdvFunc('SUMIF')" class="bg-purple-600 hover:bg-purple-500 px-3 py-1 rounded text-xs font-mono transition">SUMIF("Apple")</button>
                                <button onclick="runAdvFunc('VLOOKUP')" class="bg-emerald-600 hover:bg-emerald-500 px-3 py-1 rounded text-xs font-mono transition">VLOOKUP("Banana")</button>
                            </div>
                        </div>
                    </div>

                    <div class="bg-black/30 p-6 rounded-xl flex flex-col justify-center items-center text-center">
                        <div class="text-xs text-slate-400 mb-1" id="advFuncDesc">ç­‰å¾…æ“ä½œ...</div>
                        <div class="text-2xl font-bold text-yellow-400 font-mono" id="advFuncResult">---</div>
                    </div>
                </div>
            </div>
        </section>

        <!-- 4.5 å„²å­˜æ ¼åƒç…§ Cell Referencing -->
        <section id="sec4-5" class="scroll-mt-24">
            <div class="flex items-center gap-3 mb-6">
                <span class="bg-indigo-100 text-indigo-700 px-3 py-1 rounded-full font-bold text-sm">4.5</span>
                <h2 class="text-3xl font-bold text-slate-800">å„²å­˜æ ¼åƒç…§ (Cell Referencing)</h2>
            </div>

            <div class="grid md:grid-cols-2 gap-8">
                <!-- ç›¸å°åƒç…§ -->
                <div class="bg-white p-6 rounded-xl border border-gray-200 shadow-sm group">
                    <h3 class="text-xl font-bold text-blue-700 mb-2">ç›¸å°åƒç…§ (Relative)</h3>
                    <span class="bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded font-mono mb-4 inline-block">A1</span>
                    <p class="text-sm text-slate-600 mb-4">ç•¶è¤‡è£½å…¬å¼æ™‚ï¼Œåƒç…§åœ°å€æœƒéš¨ä½ç½®æ”¹è®Šã€‚</p>
                    <div class="bg-slate-100 p-4 rounded h-32 relative flex justify-center border overflow-hidden">
                        <div class="absolute top-4 w-32 bg-white border border-blue-300 text-blue-600 p-2 rounded text-center z-10">=A1+B1</div>
                        <div class="absolute top-4 w-32 bg-blue-600/10 border border-blue-300 text-blue-600 p-2 rounded text-center ref-anim-box group-hover:translate-y-16">
                            <span class="hidden group-hover:inline font-bold">=A2+B2</span>
                        </div>
                        <div class="absolute bottom-2 text-[10px] text-slate-400">Hover æŸ¥çœ‹è®ŠåŒ–</div>
                    </div>
                </div>

                <!-- çµ•å°åƒç…§ -->
                <div class="bg-white p-6 rounded-xl border border-gray-200 shadow-sm group">
                    <h3 class="text-xl font-bold text-rose-700 mb-2">çµ•å°åƒç…§ (Absolute)</h3>
                    <span class="bg-rose-100 text-rose-800 text-xs px-2 py-1 rounded font-mono mb-4 inline-block">$A$1</span>
                    <p class="text-sm text-slate-600 mb-4">ä½¿ç”¨ <code>$</code> é–å®šã€‚è¤‡è£½æ™‚åœ°å€ä¿æŒä¸è®Šã€‚</p>
                    <div class="bg-slate-100 p-4 rounded h-32 relative flex justify-center border overflow-hidden">
                        <div class="absolute top-4 w-32 bg-white border border-rose-300 text-rose-600 p-2 rounded text-center z-10">=$A$1*B1</div>
                        <div class="absolute top-4 w-32 bg-rose-600/10 border border-rose-300 text-rose-600 p-2 rounded text-center ref-anim-box group-hover:translate-y-16">
                            <span class="hidden group-hover:inline font-bold">=$A$1*B2</span>
                        </div>
                        <div class="absolute bottom-2 text-[10px] text-slate-400">$A$1 é–å®šäº†</div>
                    </div>
                </div>
            </div>
        </section>

        <!-- 4.6 æ•¸æ“šæ“ç¸±å’Œæ¼”ç¤º Data Manipulation & Presentation -->
        <section id="sec4-6" class="scroll-mt-24">
            <div class="flex items-center gap-3 mb-6">
                <span class="bg-indigo-100 text-indigo-700 px-3 py-1 rounded-full font-bold text-sm">4.6</span>
                <h2 class="text-3xl font-bold text-slate-800">æ•¸æ“šæ“ç¸±å’Œæ¼”ç¤º</h2>
            </div>

            <div class="bg-white p-6 rounded-2xl shadow-lg border border-slate-200">
                <div class="flex justify-center gap-4 mb-8">
                    <button onclick="showChart('column')" class="chart-btn active px-4 py-2 rounded-full border text-sm font-bold text-slate-600 hover:bg-slate-100 transition">æ£’å½¢åœ–</button>
                    <button onclick="showChart('line')" class="chart-btn px-4 py-2 rounded-full border text-sm font-bold text-slate-600 hover:bg-slate-100 transition">æŠ˜ç·šåœ–</button>
                    <button onclick="showChart('pie')" class="chart-btn px-4 py-2 rounded-full border text-sm font-bold text-slate-600 hover:bg-slate-100 transition">åœ“å½¢åœ–</button>
                    <button onclick="showChart('scatter')" class="chart-btn px-4 py-2 rounded-full border text-sm font-bold text-slate-600 hover:bg-slate-100 transition">æ•£ä½ˆåœ–</button>
                </div>

                <div class="bg-slate-50 p-6 rounded-xl flex justify-center items-center h-64 border border-slate-100 text-center">
                    <div id="chart-column" class="chart-content w-full">
                        <div class="h-32 flex items-end justify-center gap-2 mb-2">
                            <div class="w-8 h-[60%] bg-blue-500 rounded-t"></div>
                            <div class="w-8 h-[80%] bg-blue-500 rounded-t"></div>
                            <div class="w-8 h-[40%] bg-blue-500 rounded-t"></div>
                            <div class="w-8 h-[90%] bg-blue-500 rounded-t"></div>
                        </div>
                        <p class="font-bold text-slate-700">æ£’å½¢åœ– (Column Chart)</p>
                        <p class="text-xs text-slate-500">ç”¨é€”ï¼šæ¯”è¼ƒä¸åŒé …ç›®çš„æ•¸å€¼ã€‚</p>
                    </div>
                    <div id="chart-line" class="chart-content w-full hidden">
                        <svg viewBox="0 0 200 100" class="w-full h-32 mb-2"><polyline points="0,80 50,60 100,20 150,40 200,10" fill="none" stroke="#ef4444" stroke-width="3"/></svg>
                        <p class="font-bold text-slate-700">æŠ˜ç·šåœ– (Line Chart)</p>
                        <p class="text-xs text-slate-500">ç”¨é€”ï¼šé¡¯ç¤ºè¶¨å‹¢ (å¦‚æ°£æº«è®ŠåŒ–)ã€‚</p>
                    </div>
                    <div id="chart-pie" class="chart-content w-full hidden">
                        <svg viewBox="0 0 32 32" class="w-32 h-32 mx-auto mb-2 transform -rotate-90"><circle r="16" cx="16" cy="16" fill="#fbbf24" stroke="#fbbf24" stroke-width="32" stroke-dasharray="25 100"/><circle r="16" cx="16" cy="16" fill="transparent" stroke="#3b82f6" stroke-width="32" stroke-dasharray="40 100" stroke-dashoffset="-25"/></svg>
                        <p class="font-bold text-slate-700">åœ“å½¢åœ– (Pie Chart)</p>
                        <p class="text-xs text-slate-500">ç”¨é€”ï¼šé¡¯ç¤ºæ¯”ä¾‹ (å¦‚è¡€å‹åˆ†ä½ˆ)ã€‚</p>
                    </div>
                    <div id="chart-scatter" class="chart-content w-full hidden">
                         <div class="h-32 w-48 mx-auto relative mb-2 border-l border-b border-gray-400">
                             <div class="absolute left-[20%] bottom-[30%] w-2 h-2 bg-purple-600 rounded-full"></div>
                             <div class="absolute left-[50%] bottom-[60%] w-2 h-2 bg-purple-600 rounded-full"></div>
                             <div class="absolute left-[80%] bottom-[80%] w-2 h-2 bg-purple-600 rounded-full"></div>
                         </div>
                         <p class="font-bold text-slate-700">æ•£ä½ˆåœ– (Scatter Chart)</p>
                         <p class="text-xs text-slate-500">ç”¨é€”ï¼šé¡¯ç¤ºå…©è®Šæ•¸é—œä¿‚ (ç›¸é—œæ€§)ã€‚</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- 4.7 æ•¸æ“šåˆ†æ Data Analysis (UPDATED) -->
        <section id="sec4-7" class="scroll-mt-24">
            <div class="flex items-center gap-3 mb-6">
                <span class="bg-indigo-100 text-indigo-700 px-3 py-1 rounded-full font-bold text-sm">4.7</span>
                <h2 class="text-3xl font-bold text-slate-800">æ•¸æ“šåˆ†æ (Data Analysis)</h2>
            </div>

            <div class="space-y-8">
                <!-- åŸºæœ¬åˆ†æ (æ’åºèˆ‡ç¯©é¸) -->
                <div class="bg-white p-6 rounded-2xl shadow-sm border border-gray-200">
                    <p class="text-slate-600 mb-6">
                        åŸºæœ¬å·¥å…·ï¼š<span class="font-bold">æ’åº (Sorting)</span> å’Œ <span class="font-bold">ç¯©é¸ (Filtering)</span>ã€‚
                    </p>
                    <div class="bg-gray-50 p-4 rounded-xl border border-gray-200">
                        <div class="flex justify-between items-center mb-4">
                            <h4 class="font-bold text-slate-700 flex items-center gap-2"><i data-lucide="filter" class="w-4 h-4"></i> äº’å‹•åˆ†æè¡¨</h4>
                            <div class="flex gap-2 text-xs">
                                <button onclick="sortTable('score')" class="bg-white border px-2 py-1 rounded hover:bg-gray-100">æŒ‰åˆ†æ•¸æ’åº</button>
                                <button onclick="filterTable()" class="bg-indigo-600 text-white px-2 py-1 rounded hover:bg-indigo-700">ç¯©é¸åŠæ ¼ (>=50)</button>
                                <button onclick="resetTable()" class="bg-gray-200 px-2 py-1 rounded hover:bg-gray-300">é‡ç½®</button>
                            </div>
                        </div>
                        <table class="w-full text-sm text-left bg-white rounded-lg overflow-hidden shadow-sm">
                            <thead class="bg-slate-100 text-slate-600">
                                <tr>
                                    <th class="p-3 sortable-th" onclick="sortTable('name')">å§“å</th>
                                    <th class="p-3 sortable-th" onclick="sortTable('score')">åˆ†æ•¸</th>
                                </tr>
                            </thead>
                            <tbody id="analysisBody"></tbody>
                        </table>
                    </div>
                </div>

                <!-- é€²éšåˆ†æå·¥å…· (Advanced Analysis) -->
                <div class="grid md:grid-cols-2 gap-8">
                    
                    <!-- è—æœ¬ç®¡ç†å“¡ (Scenario Manager) -->
                    <div class="bg-white p-6 rounded-2xl shadow-sm border border-gray-200">
                        <div class="flex items-center gap-2 mb-4 text-rose-700">
                            <i data-lucide="layers-2" class="w-6 h-6"></i>
                            <h3 class="text-xl font-bold">è—æœ¬ç®¡ç†å“¡ (Scenario Manager)</h3>
                        </div>
                        <p class="text-sm text-slate-600 mb-4">
                            ç”¨æ–¼<span class="font-bold">ã€Œå‡è¨­åˆ†æã€ (What-if Analysis)</span>ã€‚å»ºç«‹ä¸åŒçš„æ•¸æ“šçµ„åˆï¼ˆè—æœ¬ï¼‰ï¼Œæ¯”è¼ƒä¸åŒæƒ…æ³ä¸‹çš„çµæœï¼ˆå¦‚åˆ©æ½¤é æ¸¬ï¼‰ã€‚
                        </p>
                        
                        <!-- æ¨¡æ“¬ -->
                        <div class="bg-rose-50 p-4 rounded-lg border border-rose-100">
                            <div class="flex justify-between text-xs font-bold text-rose-800 mb-2">
                                <span>é¸æ“‡æƒ…å¢ƒï¼š</span>
                                <select id="scenarioSelect" class="bg-white border border-rose-300 rounded px-2" onchange="updateScenario()">
                                    <option value="best">æ¨‚è§€ (Best)</option>
                                    <option value="normal" selected>æ­£å¸¸ (Normal)</option>
                                    <option value="worst">æ‚²è§€ (Worst)</option>
                                </select>
                            </div>
                            <div class="space-y-2 text-sm">
                                <div class="flex justify-between"><span>éŠ·é‡ï¼š</span><span id="scSales">500</span></div>
                                <div class="flex justify-between"><span>å–®åƒ¹ï¼š</span><span>$10</span></div>
                                <div class="flex justify-between font-bold text-rose-700 border-t border-rose-200 pt-1"><span>é è¨ˆæ”¶å…¥ï¼š</span><span id="scIncome">$5000</span></div>
                            </div>
                        </div>
                    </div>

                    <!-- æ¨ç´åˆ†æè¡¨ (Pivot Table) -->
                    <div class="bg-white p-6 rounded-2xl shadow-sm border border-gray-200">
                        <div class="flex items-center gap-2 mb-4 text-emerald-700">
                            <i data-lucide="table-2" class="w-6 h-6"></i>
                            <h3 class="text-xl font-bold">æ¨ç´åˆ†æè¡¨ (Pivot Table)</h3>
                        </div>
                        <p class="text-sm text-slate-600 mb-4">
                            å¾å¤§é‡è¤‡é›œçš„æ•¸æ“šä¸­ï¼Œå¿«é€Ÿ<span class="font-bold">åŒ¯ç¸½ (Summarize)</span>ã€åˆ†æåŠæ’åˆ—æ•¸æ“šã€‚ä¾‹å¦‚ï¼šè¨ˆç®—æ¯å€‹ç­åˆ¥çš„å¹³å‡åˆ†ã€‚
                        </p>

                        <!-- æ¨¡æ“¬ -->
                        <div class="bg-emerald-50 p-4 rounded-lg border border-emerald-100 text-sm">
                            <div class="text-xs text-slate-500 mb-2">åŸå§‹æ•¸æ“šï¼š1000 è¡Œå­¸ç”Ÿæˆç¸¾...</div>
                            <div class="bg-white border border-emerald-200 rounded shadow-sm overflow-hidden">
                                <table class="w-full text-center">
                                    <thead class="bg-emerald-100 text-emerald-800 text-xs">
                                        <tr><th>ç­åˆ¥</th><th>äººæ•¸</th><th>å¹³å‡åˆ†</th></tr>
                                    </thead>
                                    <tbody>
                                        <tr class="border-b border-gray-100"><td>4A</td><td>30</td><td>78.5</td></tr>
                                        <tr class="border-b border-gray-100"><td>4B</td><td>28</td><td>72.0</td></tr>
                                        <tr><td>4C</td><td>29</td><td>68.5</td></tr>
                                    </tbody>
                                </table>
                            </div>
                            <p class="text-[10px] text-emerald-600 mt-2 text-center">åªéœ€æ‹–æ”¾æ¬„ä½ï¼Œå³å¯è‡ªå‹•ç”Ÿæˆæ­¤è¡¨ã€‚</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- ç¸½çµæ¸¬é©— -->
        <section class="bg-indigo-900 text-white rounded-3xl p-8 md:p-12 text-center relative overflow-hidden mt-12">
            <h2 class="text-3xl font-bold mb-8 relative z-10">ğŸš€ ç¬¬å››ç«  ç¸½çµæ¸¬é©—</h2>
            <div class="max-w-2xl mx-auto space-y-6 relative z-10 text-left">
                <div class="bg-indigo-800 p-6 rounded-xl border border-indigo-700">
                    <p class="font-bold text-lg mb-4">1. å“ªå€‹å‡½æ•¸å¯ä»¥ç”¨ä¾†è¨ˆç®—ç¬¦åˆç‰¹å®šæ¢ä»¶çš„å„²å­˜æ ¼æ•¸ç›®ï¼Ÿ</p>
                    <div class="grid grid-cols-2 gap-3">
                        <button class="quiz-btn p-3 bg-indigo-950 rounded hover:bg-indigo-700 transition" onclick="checkFinalQuiz(this, false)">SUMIF</button>
                        <button class="quiz-btn p-3 bg-indigo-950 rounded hover:bg-indigo-700 transition" onclick="checkFinalQuiz(this, true)">COUNTIF</button>
                    </div>
                </div>
                <div class="bg-indigo-800 p-6 rounded-xl border border-indigo-700">
                    <p class="font-bold text-lg mb-4">2. è‹¥è¦é€²è¡Œã€Œå‡è¨­åˆ†æã€ï¼Œæ¯”è¼ƒä¸åŒæƒ…å¢ƒä¸‹çš„çµæœï¼Œæ‡‰ä½¿ç”¨ï¼Ÿ</p>
                    <div class="grid grid-cols-2 gap-3">
                        <button class="quiz-btn p-3 bg-indigo-950 rounded hover:bg-indigo-700 transition" onclick="checkFinalQuiz(this, true)">è—æœ¬ç®¡ç†å“¡ (Scenario Manager)</button>
                        <button class="quiz-btn p-3 bg-indigo-950 rounded hover:bg-indigo-700 transition" onclick="checkFinalQuiz(this, false)">æ’åº (Sorting)</button>
                    </div>
                </div>
            </div>
        </section>

    </main>

    <!-- é å°¾ -->
    <footer class="bg-slate-100 py-8 mt-12 text-center text-slate-500 text-sm">
        <p>é«˜ä¸­ ICT å­¸ç¿’è³‡æºç¶² &copy; 2025</p>
    </footer>

    <script>
        lucide.createIcons();

        // é€²åº¦æ¢
        window.onscroll = function() {
            let winScroll = document.body.scrollTop || document.documentElement.scrollTop;
            let height = document.documentElement.scrollHeight - document.documentElement.clientHeight;
            let scrolled = (winScroll / height) * 100;
            document.getElementById("progressBar").style.width = scrolled + "%";
        };

        // 4.1 è©¦ç®—è¡¨äº’å‹•
        function activateCell(cell, address, content) {
            document.querySelectorAll('.sheet-cell').forEach(c => c.classList.remove('active'));
            cell.classList.add('active');
            document.getElementById('nameBox').textContent = address;
            document.getElementById('formulaBar').value = content;
        }

        // 4.2 æ•¸æ“šè¼¸å…¥åµæ¸¬
        function detectDataType() {
            const input = document.getElementById('dataInput').value;
            const resultDiv = document.getElementById('dataResult');
            const previewDiv = document.getElementById('formatPreview');
            
            if(!input) {
                resultDiv.innerHTML = "ç­‰å¾…è¼¸å…¥...";
                resultDiv.className = "p-3 bg-white rounded-lg border border-slate-200 text-center text-sm font-bold text-slate-400";
                previewDiv.classList.add('hidden');
                return;
            }

            const isNumber = !isNaN(parseFloat(input)) && isFinite(input);
            
            if(input.startsWith('=')) {
                resultDiv.innerHTML = `<span class="text-purple-600">é€™æ˜¯ å…¬å¼ (Formula)</span>`;
                resultDiv.className = "p-3 bg-purple-50 rounded-lg border border-purple-200 text-center text-sm font-bold";
                previewDiv.classList.add('hidden');
            } else if (isNumber) {
                resultDiv.innerHTML = `<span class="text-emerald-600">é€™æ˜¯ æ•¸å€¼ (Value)</span> <span class="text-xs text-emerald-400 block font-normal">é è¨­é å³å°é½Š</span>`;
                resultDiv.className = "p-3 bg-emerald-50 rounded-lg border border-emerald-200 text-center text-sm font-bold";
                
                const num = parseFloat(input);
                document.getElementById('fmtCurrency').textContent = '$' + num.toFixed(2);
                document.getElementById('fmtPercent').textContent = (num * 100).toFixed(0) + '%';
                previewDiv.classList.remove('hidden');
            } else {
                resultDiv.innerHTML = `<span class="text-orange-600">é€™æ˜¯ æ–‡å­— (Label)</span> <span class="text-xs text-orange-400 block font-normal">é è¨­é å·¦å°é½Š</span>`;
                resultDiv.className = "p-3 bg-orange-50 rounded-lg border border-orange-200 text-center text-sm font-bold";
                previewDiv.classList.add('hidden');
            }
        }

        // 4.4 é€²éšå‡½æ•¸å¯¦é©—å®¤
        function runAdvFunc(funcType) {
            const resultBox = document.getElementById('advFuncResult');
            const descBox = document.getElementById('advFuncDesc');
            
            let result = "";
            let desc = "";

            // æ¨¡æ“¬æ•¸æ“š: A1:A4 -> Apple, Banana, Apple, Orange. B1:B4 -> 50, 30, 20, 80
            switch(funcType) {
                case 'LEN': 
                    result = "5"; 
                    desc = 'LEN("Apple") = 5 (å­—ç¬¦é•·åº¦)'; 
                    break;
                case 'LEFT': 
                    result = "HK"; 
                    desc = 'LEFT("HK123", 2) = "HK" (å–å·¦é‚Š2å­—)'; 
                    break;
                case 'COUNTIF': 
                    result = "2"; 
                    desc = 'COUNTIF(A1:A4, "Apple") = 2 (å‡ºç¾2æ¬¡)'; 
                    break;
                case 'SUMIF': 
                    result = "70"; 
                    desc = 'SUMIF(A1:A4, "Apple", B1:B4) = 50 + 20 = 70'; 
                    break;
                case 'VLOOKUP': 
                    result = "30"; 
                    desc = 'VLOOKUP("Banana", A1:B4, 2, FALSE) = 30'; 
                    break;
            }
            
            resultBox.textContent = result;
            descBox.textContent = desc;
            
            // Animation
            resultBox.classList.remove('text-yellow-400');
            void resultBox.offsetWidth;
            resultBox.classList.add('text-yellow-400');
        }

        // 4.6 åœ–è¡¨åˆ‡æ›
        function showChart(type) {
            document.querySelectorAll('.chart-content').forEach(el => el.classList.add('hidden'));
            document.querySelectorAll('.chart-btn').forEach(btn => btn.classList.remove('active'));
            document.getElementById('chart-' + type).classList.remove('hidden');
            
            // Activate button logic (simplified)
            const btns = document.querySelectorAll('.chart-btn');
            if(type === 'column') btns[0].classList.add('active');
            if(type === 'line') btns[1].classList.add('active');
            if(type === 'pie') btns[2].classList.add('active');
            if(type === 'scatter') btns[3].classList.add('active');
        }

        // 4.7 æ•¸æ“šåˆ†æè¡¨æ ¼é‚è¼¯
        const initialData = [
            { name: "Alice", score: 85 },
            { name: "Bob", score: 42 },
            { name: "Charlie", score: 60 },
            { name: "Dave", score: 30 },
            { name: "Eve", score: 95 }
        ];
        let tableData = [...initialData];

        function renderTable() {
            const tbody = document.getElementById('analysisBody');
            tbody.innerHTML = tableData.map(row => `
                <tr class="border-b border-slate-100 hover:bg-slate-50 transition">
                    <td class="p-3">${row.name}</td>
                    <td class="p-3 font-mono ${row.score < 50 ? 'text-red-500 font-bold' : 'text-emerald-600'}">${row.score}</td>
                </tr>
            `).join('');
        }
        
        function sortTable(key) {
            tableData.sort((a, b) => a[key] > b[key] ? 1 : -1);
            renderTable();
        }

        function filterTable() {
            tableData = initialData.filter(row => row.score >= 50);
            renderTable();
        }

        function resetTable() {
            tableData = [...initialData];
            renderTable();
        }
        
        // 4.7 è—æœ¬ç®¡ç†å“¡é‚è¼¯
        function updateScenario() {
            const scenario = document.getElementById('scenarioSelect').value;
            const salesEl = document.getElementById('scSales');
            const incomeEl = document.getElementById('scIncome');
            
            let sales = 500;
            if(scenario === 'best') sales = 800;
            if(scenario === 'worst') sales = 200;
            
            salesEl.textContent = sales;
            incomeEl.textContent = '$' + (sales * 10);
            
            incomeEl.classList.add('animate-pulse');
            setTimeout(() => incomeEl.classList.remove('animate-pulse'), 500);
        }

        // Init
        renderTable();

        // æ¸¬é©—
        function checkFinalQuiz(btn, isCorrect) {
            if (isCorrect) {
                btn.classList.add('correct-anim', 'bg-green-600');
                btn.innerHTML += ' âœ…';
            } else {
                btn.classList.add('wrong-anim', 'bg-red-600');
                btn.innerHTML += ' âŒ';
            }
        }
    </script>
</body>
</html>
